#
# MOS6510 CPU test suite.
#
# If a test fails the emulator is halted with exit code 0.
# If all tests succeed the emulator is terminated with exit code 1.
#
########################################
# Clean registers
########################################
a 5000
a9 00
a0 00
a2 00
48
28
.
b 5008


########################################
# ASL $zp - 06
########################################
#
# lda #$aa
# sta $0050
# asl $50
# lda $50
#
a 4000
ea
a9 aa
8d 50 00
06 50
a5 50
02
.
b 4003 rp == #$a0
b 4008 rp == #$21
b 400a ra == #$54
g 5000
g 4000
g .
g .
bd 4003
bd 4008
bd 400a


########################################
# ASL - 0A
########################################
#
# lda #$55
# asl
#
a 4000
ea
a9 55
0a
ea
02
.
b 4003 rp == #$20
b 4004 rp == #$a0
b 4005 ra == #$aa
g 5000
g 4000
g .
g .
bd 4003
bd 4004
bd 4005


########################################
# ASL $abs - 0E
########################################
#
# lda #$aa
# sta $0050
# asl $0050
# lda $50
#
a 4000
ea
a9 aa
8d 50 00
0e 50 00
a5 50
02
.
b 4003 rp == #$a0
b 4009 rp == #$21
b 400b ra == #$54
g 5000
g 4000
g .
g .
bd 4003
bd 4009
bd 400b


########################################
# ASL $zp, X - 16
########################################
#
# lda #$aa
# sta $0050
# ldx #$01
# asl $4f, x
# lda $50
#
a 4000
ea
a9 aa
8d 50 00
a2 01
16 4f
a5 50
02
.
b 4003 rp == #$a0
b 400a rp == #$21
b 400c ra == #$54
g 5000
g 4000
g .
g .
bd 4003
bd 400a
bd 400c


########################################
# ASL $abs, X - 1E
########################################
#
# lda #$aa
# sta $0050
# ldx #$01
# asl $4f, x
# lda $50
#
a 4000
ea
a9 aa
8d 50 00
a2 01
1E 4f 00
a5 50
02
.
b 4003 rp == #$a0
b 400b rp == #$21
b 400d ra == #$54
g 5000
g 4000
g .
g .
bd 4003
bd 400b
bd 400d


########################################
# ROL $zp - 26
########################################
#
# lda #$aa
# sta $0050
# sec
# rol $50
# lda $50
#
a 4000
ea
a9 aa
8d 50 00
38
26 50
a5 50
02
.
b 4007 rp == #$a1
b 4009 rp == #$21
b 400b ra == #$55
g 5000
g 4000
g .
g .
bd 4007
bd 4009
bd 400b


########################################
# ROL - 2A
########################################
#
# lda #$55
# rol
#
a 4000
ea
a9 55
2a
ea
02
.
b 4003 rp == #$20
b 4004 rp == #$a0
b 4005 ra == #$aa
g 5000
g 4000
g .
g .
bd 4003
bd 4004
bd 4005


########################################
# ROL $abs - 2E
########################################
#
# lda #$aa
# sta $0050
# sec
# rol $0050
# lda $50
#
a 4000
ea
a9 aa
8d 50 00
38
2e 50 00
a5 50
02
.
b 4007 rp == #$a1
b 400a rp == #$21
b 400c ra == #$55
g 5000
g 4000
g .
g .
bd 4007
bd 400b
bd 400c


########################################
# ROL $zp, X - 36
########################################
#
# lda #$aa
# sec
# sta $0050
# ldx #$01
# rol $4f, x
# lda $50
#
a 4000
ea
a9 aa
38
8d 50 00
a2 01
36 4f
a5 50
02
.
b 4004 rp == #$a1
b 400b rp == #$21
b 400d ra == #$55
g 5000
g 4000
g .
g .
bd 4004
bd 400b
bd 400d


########################################
# ROL $abs, X - 3E
########################################
#
# lda #$aa
# sec
# sta $0050
# ldx #$01
# rol $004f, x
# lda $50
#
a 4000
ea
a9 aa
38
8d 50 00
a2 01
3e 4f 00
a5 50
02
.
b 4004 rp == #$a1
b 400c rp == #$21
b 400e ra == #$55
g 5000
g 4000
g .
g .
bd 4004
bd 400c
bd 400e


########################################
# LSR $zp - 46
########################################
#
# lda #$aa
# sta $0050
# lsr $50
# lda $50
#
a 4000
ea
a9 aa
8d 50 00
46 50
a5 50
02
.
b 4003 rp == #$a0
b 4008 rp == #$20
b 400a ra == #$55
g 5000
g 4000
g .
g .
bd 4003
bd 4008
bd 400a


########################################
# LSR - 4A
########################################
#
# lda #$55
# lsr
#
a 4000
ea
a9 55
4a
ea
02
.
b 4003 rp == #$20
b 4004 rp == #$21
b 4005 ra == #$2a
g 5000
g 4000
g .
g .
bd 4003
bd 4004
bd 4005


########################################
# LSR $abs - 4E
########################################
#
# lda #$aa
# sta $0050
# lsr $0050
# lda $50
#
a 4000
ea
a9 aa
8d 50 00
4e 50 00
a5 50
02
.
b 4003 rp == #$a0
b 4009 rp == #$20
b 400b ra == #$55
g 5000
g 4000
g .
g .
bd 4003
bd 4009
bd 400b


########################################
# LSR $zp, X - 56
########################################
#
# lda #$aa
# sta $0050
# ldx #$01
# lsr $4f, x
# lda $50
#
a 4000
ea
a9 aa
8d 50 00
a2 01
56 4f
a5 50
02
.
b 4003 rp == #$a0
b 400a rp == #$20
b 400c ra == #$55
g 5000
g 4000
g .
g .
bd 4003
bd 400a
bd 400c


########################################
# LSR $abs, X - 5E
########################################
#
# lda #$aa
# sta $0050
# ldx #$01
# lsr $4f, x
# lda $50
#
a 4000
ea
a9 aa
8d 50 00
a2 01
5e 4f 00
a5 50
02
.
b 4003 rp == #$a0
b 400b rp == #$20
b 400d ra == #$55
g 5000
g 4000
g .
g .
bd 4003
bd 400b
bd 400d


########################################
# ROR $zp - 66
########################################
#
# lda #$aa
# sta $0050
# ror $50
# lda $50
#
a 4000
ea
a9 aa
8d 50 00
66 50
a5 50
02
.
b 4003 rp == #$a0
b 4008 rp == #$20
b 400a ra == #$55
g 5000
g 4000
g .
g .
bd 4003
bd 4008
bd 400a


########################################
# ROR - 6A
########################################
#
# lda #$55
# sec
# ror
#
a 4000
ea
a9 55
38
6a
ea
02
.
b 4003 rp == #$20
b 4005 rp == #$a1
b 4006 ra == #$aa
g 5000
g 4000
g .
g .
bd 4003
bd 4005
bd 4006


########################################
# ROR $zp, X - 76
########################################
#
# lda #$aa
# sta $0050
# ldx #$01
# ror $4f, x
# lda $50
#
a 4000
ea
a9 aa
8d 50 00
a2 01
76 4f
a5 50
02
.
b 4003 rp == #$a0
b 400a rp == #$20
b 400c ra == #$55
g 5000
g 4000
g .
g .
bd 4003
bd 400a
bd 400c


########################################
# ROR $abs, X - 7E
########################################
#
# lda #$aa
# sta $0050
# ldx #$01
# ror $004f, x
# lda $50
#
a 4000
ea
a9 aa
8d 50 00
a2 01
7e 4f 00
a5 50
02
.
b 4003 rp == #$a0
b 400b rp == #$20
b 400d ra == #$55
g 5000
g 4000
g .
g .
bd 4003
bd 400b
bd 400d


#
# Success
#
quit 1